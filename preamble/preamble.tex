
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PACKAGES
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{etex}

\usepackage{multicol}
\usepackage[intoc]{nomencl}
\usepackage[left=3cm,right=2.5cm,top=1.5cm,bottom=1.5cm,includeheadfoot]{geometry}
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc}
\usepackage{newtxtext}%\usepackage{mathptmx} to stop mathcal strange output
\usepackage[scaled=.92]{helvet}
\usepackage{courier}
\usepackage{titlesec}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsopn}
\usepackage{amsbsy}
\usepackage{amsfonts}
\usepackage{booktabs}
\usepackage{stmaryrd}
\usepackage{cancel}
\usepackage[procnames]{listings}
\usepackage{chngcntr}
\usepackage{color}
\usepackage{textcomp}
\usepackage{setspace}
\usepackage{palatino}
\usepackage[algoruled, linesnumbered, algochapter]{algorithm2e}
\usepackage{color}
\usepackage{colortbl}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{rotating}
\usepackage[pdftex]{hyperref}
\usepackage[bf]{caption} 
\usepackage{pdfpages}
\PassOptionsToPackage{hyphens}{url}\usepackage{hyperref}
\usepackage{multirow}
\usepackage[round]{natbib}
\usepackage{lipsum}
\usepackage{fancyhdr}
\usepackage{longtable}
\usepackage{tabularx}
\usepackage{bm}
\usepackage{latexsym}
\usepackage{times}
\usepackage{verbatim} 
\usepackage{array}
\usepackage{mathrsfs}
\usepackage[section]{placeins} % force figures appear in its section
\usepackage{makecell}
\usepackage{tikz}
%\usepackage[decimalsymbol=comma]{siunitx}
\usepackage[quantity-product = {,}]{siunitx}
\usepackage{supertabular}
\usepackage{scrhack}

\usepackage{textpos}
\setlength{\TPHorizModule}{1cm} % horizontal unit
\setlength{\TPVertModule}{1cm} % vertical unit

\usepackage{hhline}

\usepackage[germanb,english]{babel}

\usepackage{etoolbox}
\usepackage{graphicx}
\usepackage{subcaption}

%\usepackage{amsmath}
%\usepackage{amssymb}
%\usepackage{unicode-math} mathcal doesn't work properly
%\setmathfont{Latin Modern Math}
%\setmathfont[range={\mathcal,\mathbfcal},StylisticSet=1]{XITS Math}
%setmathfont[range=\mathscr]{XITS Math}
%\usepackage{mathrsfs}

%\usepackage{lipsum}% http://ctan.org/pkg/lipsum caption next page
%\usepackage{ccaption}% http://ctan.org/pkg/ccaption caption next page


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% COMMAND DEFINITIONS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\SetSymbolFont{stmry}{bold}{U}{stmry}{m}{n}

% define PDF version
\pdfminorversion=6

% Fat plus symbol
\newcommand{\Plus}{\mathord{\begin{tikzpicture}[baseline=0ex, line width=1.5, scale=0.13]
\draw (1,0) -- (1,2);
\draw (0,1) -- (2,1);
\end{tikzpicture}}}

% Fat minus symbol
\newcommand{\Minus}{\mathord{\begin{tikzpicture}[baseline=0ex, line width=1.5, scale=0.13]
\draw (0,1) -- (2,1);
\end{tikzpicture}}}

% Glossary
\renewcommand{\nomname}{}
\renewcommand{\nomlabel}[1]{\textbf{#1}}
\makenomenclature
\renewcommand{\nomname}{Glossary}
\newcommand{\g}{\footnote{For all abbreviations see the glossary on page \pageref{nom}.}}
\makeatletter
\def\thenomenclature{%
	\chapter*{\nomname}
	\if@intoc\addcontentsline{toc}{section}{\nomname}\fi%
	\nompreamble
	\list{}{%
		\labelwidth\nom@tempdim
		\leftmargin\labelwidth
		\advance\leftmargin\labelsep
		\itemsep\nomitemsep
		\let\makelabel\nomlabel}}
\makeatother

\renewcommand*\chapterheadstartvskip{\vspace*{-1cm}}
\setkomafont{sectioning}{\normalfont\bfseries}
\setkomafont{captionlabel}{\normalfont\bfseries} 
\newcommand{\todo}[1]{ \textbf{(TODO: #1)}}
\newcommand{\gt}[1]{ \langle \text{#1}\rangle }
\newcommand{\E}{\mbox{I\negthinspace E}}
\newcommand{\s}[1]{\texttt{\large{#1}}}
\newcommand{\co}[1]{\texttt{\large{#1}}}

% define footnote
% \renewcommand{\thefootnote}{\fnsymbol{footnote}}

% define how chapter looks like
\titleformat{\chapter}[display]
{\bfseries\Large}
{\vspace{-5ex}\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}
{0ex}
{\titlerule
\vspace{1.5ex}%
\filright}
[\vspace{1.5ex}%
\titlerule\vspace{-3ex}]

% define section
\titleformat{\section}[display]
{\bfseries\Large}
{}
{-2ex}
{\thesection \hspace{0.3cm}\filright }
[\vspace{-1ex} \parbox{0.618\textwidth}{\titlerule}\vspace{-1ex}]

% define subsection
\titleformat{\subsection}[display]
{\bfseries\large}
{}
{-2ex}
{\thesubsection \hspace{0.3cm}\filright }
[\vspace{-1ex}]


% define subsubsection
\titleformat{name=\subsubsection,numberless}[display]
{\bfseries\large}
{}
{-2ex}
{\filright}
[\vspace{-1ex}]

\newtheorem{mydef}{Definition}[chapter]
\newtheorem{mylemma}[mydef]{Lemma}
\newtheorem{mycorollary}[mydef]{Corollary}
\newtheorem{bsp}[mydef]{Beispiel}
\newtheorem{theorem}[mydef]{Theorem}


\newcommand{\argmax}[1]{\underset{#1}{\operatorname{arg}\,\operatorname{max}}\;}
\newcommand{\argmin}[1]{\underset{#1}{\operatorname{arg}\,\operatorname{min}}\;}
\newcommand{\argmaxu}[1]{\operatorname{\operatorname{arg}\,\operatorname{max}_{#1}}}
\newcommand{\nuc}[1]{#1}
\newcommand{\signalmatrix}[1]{\mathbf{#1}}
\newcommand{\seq}{\mathcal{A}}
\newcommand{\w}{w}
\newcommand{\drsp}{\mathrm{DRSP}}
\newcommand{\drspart}{\mathrm{DRS}-\textnormal{Partition}}
\newcommand{\zB}{z.\,B. }
\newcommand{\dhe}{d.\,h. }
\newcommand{\mds}{\mathrm{MDS}}
\newcommand{\mdsfett}{\mathrm{\textbf{MDS}}}
\newcommand{\defgl}{\mathrel{\mathop{\raisebox{1pt}{\scriptsize$:$}}}=}
\newcommand{\rc}[1]{\overline{#1}}
\newcommand{\onO}[1]{\mathcal{O}\left(#1\right)}
\newcommand{\onOg}[1]{\mathcal{O} \Big(#1\Big)}
\newcommand{\onOgg}[1]{\mathcal{O} \big(#1\big)}
\newcommand{\onOl}[1]{\mathcal{O} \Bigg(#1\Bigg)}
\newcommand{\pvalue}{\text{p-value}}
\newcommand{\mcdf}{$\tilde F_T$}

\definecolor{orange}{rgb}{1,0.5,0} 
\definecolor{gray}{gray}{0.5}
\definecolor{green}{rgb}{0,0.5,0}
\definecolor{lightgreen}{rgb}{0,0.7,0}
\definecolor{purple}{rgb}{0.5,0,0.5}
\definecolor{darkred}{rgb}{0.5,0,0}

%% This declares a command \Comment
%% The argument will be surrounded by //
\SetKwComment{Comment}{// }{}
\SetKwInOut{Input}{Input}
\SetKwInOut{Output}{Output}
\SetKwInOut{Parameter}{Parameter}
\SetKw{KwBy}{by}

\definecolor{hellgrau}{rgb}{0.92,0.92,0.92}
\definecolor{dunkelgrau}{rgb}{0.8,0.8,0.8}

%\captionsetup{format=hang} 
\captionsetup{labelfont={bf,normalsize}, textfont={normalsize}, margin=0pt, aboveskip=2pt}

%\setlength{\abovecaptionskip}{0.2cm}

\hypersetup{
	pdftitle={Computational Method for Single-cell ATAC-seq Imputation and Dimensionality Reduction},
	pdfauthor={Mingbo Cheng},
	pdfpagemode=UseOutlines,
	pdfdisplaydoctitle=true,
        colorlinks,
        citecolor=black,
        filecolor=black,
        linkcolor=black,
        urlcolor=black,
	bookmarksnumbered=true,
	pdfstartview={Fit},
	pdfpagelayout=SinglePage
}

\pagestyle{fancy}
\fancyhf{}

\fancyhead[EL]{\nouppercase{\rightmark}}
\fancyhead[OR]{\nouppercase{\rightmark}}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[EL]{\thepage}
\fancyfoot[OR]{\thepage}

\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\labelenumii}{(\roman{enumii})}

\newcommand\leerseite{\newpage\thispagestyle{empty}\hspace{1cm}\newpage}
\newcommand\approxy{{\raise.17ex\hbox{$\scriptstyle\sim$}}}

\renewcommand{\multirowsetup}{\centering}

\newcommand*\diff{\mathop{}\!\mathrm{d}}

\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}

\definecolor{DGreen}{HTML}{92F9A5}
\definecolor{LGreen}{HTML}{D0F8D8}

\definecolor{DBlue}{HTML}{8B99D7}
\definecolor{LBlue}{HTML}{CAD3FA}

\definecolor{DRed}{HTML}{FA9F9C}
\definecolor{LRed}{HTML}{FCE0DF}

\definecolor{DGray}{HTML}{CDCBCB}
\definecolor{LGray}{HTML}{E9E7E7}

\newcolumntype{A}{>{\columncolor{DGreen}}c}
\newcolumntype{B}{>{\columncolor{LGreen}}c}
\newcolumntype{C}{>{\columncolor{DBlue}}c}
\newcolumntype{D}{>{\columncolor{LBlue}}c}
\newcolumntype{E}{>{\columncolor{DRed}}c}
\newcolumntype{F}{>{\columncolor{LRed}}c}
\newcolumntype{G}{>{\columncolor{DGray}}c}
\newcolumntype{H}{>{\columncolor{LGray}}c}

\setlength{\textfloatsep}{20.0pt plus 2.0pt minus 5.0pt}
\setlength{\floatsep}{20.0pt plus 2.0pt minus 5.0pt}
\setlength{\intextsep}{20.0pt plus 2.0pt minus 5.0pt}

% set space
 \onehalfspacing

\newsavebox\ltmcbox

\def\shortlipsum{\par Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Ut purus elit, vestibulum ut, placerat ac, adipiscing vitae, felis. Curabitur dictum gravida mauris. Nam arcu libero, nonummy eget, consectetuer id, vulputate a, magna. Donec vehicula augue eu neque.\par}

\newcounter{entryno}
\setcounter{entryno}{1}
\def\tabline{Test & \the\value{entryno} & Description\addtocounter{entryno}{1}\\}
\def\tablines{\tabline\tabline\tabline\tabline\tabline}

\renewcommand{\autodot}{}% Remove all end-of-counter dots

\newcommand{\fref}[1]{Figure~\ref{#1}}
\newcommand{\tref}[1]{Table~\ref{#1}}
\newcommand{\eref}[1]{Equation~\ref{#1}}
\newcommand{\cref}[1]{Chapter~\ref{#1}}
\newcommand{\sref}[1]{Section~\ref{#1}}
\newcommand{\atref}[1]{Appendix Table~\ref{#1}}
\newcommand{\afref}[1]{Appendix Figure~\ref{#1}}
\newcommand{\alref}[1]{Algorithm~\ref{#1}}

\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}p{#1}}
\newcolumntype{L}[1]{>{\raggedright\arraybackslash}p{#1}}

\def\fs{\kern 0.33em}
